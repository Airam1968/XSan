*********************************************************************
* Sistema     : Gest∆o de Financiamentos
* Copyright   : Airam Miranda de Almeida
* Programador : Airam Miranda de Almeida
*********************************************************************
* Programa    : CON_BOLE.PRG
* Data        : 01/01/99
* Objetivo    : CONSULTA DE NUMERO DE BOLETOS
* PRG"s       : ---
* DBF"s       : ---
* Alteracao   :
*********************************************************************
FUNCTION CON_BOLE()
SAVE SCREEN TO TELA03
PTIT("CONSULTA DE NUMERO DE BOLETOS")
SELE 1
USE UNI_IMOB INDEX UNI_IMOB
GOTO TOP
SELE 2
USE CLAS_PRO INDEX CLAS_PRO
GOTO TOP
SELE 3
USE CAD_QUAD INDEX CAD_QUAD
GOTO TOP
SELE 4
USE CAD_APAR INDEX CAD_APAR
GOTO TOP
SELE 5
USE CONTATO INDEX NUM_CLIE,CONTATO
GOTO TOP
SELE 6
USE CAD_VEND INDEX CAD_VEND,DATA_VEN
GOTO TOP
SELE 8
* Cadastro de Parcelas
SELE 2
* Selecao do produto
DO WHILE .T.
   PLIMPA()
   SET COLOR TO W/N,+W/R
   eCLAS_PRO = 0
   eTIPO_PRO = 0
   @ 05,02 SAY "Produto : "
   GO TOP
   DECLARE CAMPO[3],PIC[3],CAB[3],LENS[3]
   AFIELDS(CAMPO,.T.,LENS)
   PIC[1]="@R99999"
   PIC[2]="@R99999"
   PIC[3]="@S40"
   CAB[1]="    "
   CAB[2]="    "
   CAB[3]="    "
   DBEDIT(5,15,5,70,CAMPO,"FUNC_CONS",PIC,CAB," "," - "," ")
   eCLAS_PRO = CODIGO
   eTIPO_PRO = TIPO
   eDESC_PRO = DESCRICAO
   EXIT
ENDDO
eBOLETO   = SPACE(15)
DO WHILE .T.
   @ 07,02 SAY "Boleto  : " GET eBOLETO  
   READ
   IF eBOLETO = SPACE(15)
      PLQUA("01")
      PMSGR("C¢digo Invalido !",3)
      LOOP
   ELSE
      eBOLETO = ALLTRIM(eBOLETO)
      EXIT
   ENDIF
ENDDO
*
PLQUA("01")
eORIGEM = SPACE(1)
*PLQUA("01")
*@ 23,00 SAY "Origem dos Pagamentos (C)arteira,(B)anco ou (A)mbas ? " GET eORIGEM PICT "@!X" VALID eORIGEM $("CBA")
*READ
eORIGEM = "A"
eTIPO = SPACE(1)
*PLQUA("01")
*@ 23,00 SAY "Tipo de Parcelas (S)inal,(N)ormais,(I)ntermediarias ou (A)mbas ? " GET eTIPO PICT "@!X" VALID eTIPO $("SNIA")
*READ
eTIPO = "A"
ePROTESTO = SPACE(1)
*PLQUA("01")
*@ 23,00 SAY "Selecionar Tátulos á (P)rotesto,(N)áo Protesto ou (A)mbos ? " GET ePROTESTO PICT "@!X" VALID ePROTESTO $("PNA")
*READ
ePROTESTO = "A"
eORDEM = SPACE(1)
*PLQUA("01")
*@ 23,00 SAY "Emissáo de Relatário por (O)rdem de Pagamento ou (I)movel (O/I) ? " GET eORDEM PICT "@!X" VALID eORDEM $("OI")
*READ
eORDEM = "I"
*PLQUA("01")
ePERIODO = SPACE(1)
*@ 23,00 SAY "Selecionar Pagamentos (A)ntecipado, (P)ostergado, (M)es ou (T)odos (A/P/M/T) ? " GET ePERIODO PICT "@!X" VALID ePERIODO $("APMT")
*READ
ePERIODO = "T"
*
IF eTIPO_PRO = 1
   SELE 3
   SET FILTER TO NUM_LOTEAM = STR(eCLAS_PRO,5)
   GOTO TOP
ELSE
   SELE 4
   SET FILTER TO NUM_LOTEAM = STR(eCLAS_PRO,5)
   GOTO TOP
ENDIF
eSUB_TOT  = 0
eTOT_TOT  = 0
eTOTAL    = 0
SELE 9
SET EXCLUSIVE ON
USE TEMP_PAR
IF F_BLOQA()
   ZAP
   GOTO TOP
   UNLOCK
ENDIF
SET EXCLUSIVE OFF
IF eTIPO_PRO = 1
   SELE 3
ELSE
   SELE 4
ENDIF
DO WHILE .NOT. EOF()
   IF eTIPO_PRO = 1
      SELE 3
      eQUADRA = NUM_QUADRA
   ELSE
      SELE 4
      eQUADRA = NUM_BLOCO
   ENDIF
   SELE 8
   eIND_CLAS = STR(eCLAS_PRO,5)
   eIND_QUAD = eQUADRA
   eZERO = "000"
   eARQ  = "CP"+SUBSTR(eZERO,1,(3-LEN(ALLTRIM(eIND_CLAS))))+ALLTRIM(eIND_CLAS)+SUBSTR(eZERO,1,(3-LEN(ALLTRIM(eIND_QUAD))))+ALLTRIM(eIND_QUAD) 
   SELE 9
   USE TEMP_PAR
   IF F_BLOQA()

      PLQUA("01")
      @ 23,00 SAY "Arquivo : " + eARQ

      DO SEL_BOLE

      GOTO TOP
      UNLOCK
   ENDIF
   IF eTIPO_PRO = 1
      SELE 3
      SKIP
   ELSE
      SELE 4
      SKIP
   ENDIF
ENDDO
SELE 9
USE TEMP_PAR
GOTO TOP
IF eORDEM = "D"
   INDEX ON DATA_VENC TO TEMP_PAR
   GOTO TOP
ELSE
   INDEX ON CLASSE+QUADRA+NUM_IMOVEL+STR(PARTE,1) TO TEMP_PAR
   GOTO TOP
ENDIF
IF EOF()
   PLQUA("01")
   PMSGR("Atená∆o !",3)
   PMENSAG("N∆o H† Boletos com o Codigo ("+eBOLETO+") !")
   PPARA()
ELSE
   DECLARE CAMPO[17],PIC[17],CAB[17],LENS[17]
   AFIELDS(CAMPO,.T.,LENS)
   CAMPO[1] ="QUADRA" 
   CAMPO[2] ="NUM_IMOVEL"
   CAMPO[3] ="NUM_PARC"
   CAMPO[4] ="TIPO_PARC"
   CAMPO[5] ="DATA_VENC"
   CAMPO[6] ="VLR_PARC"
   CAMPO[7] ="DATA_PGTO"
   CAMPO[8] ="VLR_PGTO"
   CAMPO[9] ="ALLTRIM(COD_BANCO)"
   CAMPO[10] ="ORIGEM"
   CAMPO[11]="PROTESTO"
   CAMPO[12]="CONTABIL"
   CAMPO[13]="OBS"
   CAMPO[14]="MULTA"
   CAMPO[15]="COMISSAO"
   CAMPO[16]="PERCENTUAL" 
   CAMPO[17]="CONTA"
   LENS[1] =5
   LENS[2] =5
   LENS[3] =5
   LENS[4] =3
   LENS[5] =8
   LENS[6] =19
   LENS[7] =8
   LENS[8] =19
   LENS[9] =12
   LENS[10]=1
   LENS[11]=1
   LENS[12]=1
   LENS[13]=10
   LENS[14]=10
   LENS[15]=10
   LENS[16]=10
   LENS[17]=3    
   PIC[1] ="@R99999"   
   PIC[2] ="@R99999"
   PIC[3] ="@R99999"
   PIC[4] ="XXX"
   PIC[5] ="99/99/99"
   PIC[6] ="@R 99,999,999,999.99"
   PIC[7] ="99/99/99"
   PIC[8] ="@R 99,999,999,999.99"
   PIC[9] ="@R 999999999999"
   PIC[10] ="@!X"
   PIC[11]="L"
   PIC[12]="L"
   PIC[13]="XXXXXXXXXX"
   PIC[14]="@R 999.99"
   PIC[15]="@R 999.99"
   PIC[16]="@R 999.99"
   PIC[17]="@R 999"
   CAB[1] ="Blc\Qdr"   
   CAB[2] ="Unidade"
   CAB[3] ="Parcela"
   CAB[4] ="Tipo(N/I)"
   CAB[5] ="Venc."
   CAB[6] ="Parcela"
   CAB[7] ="Pago"
   CAB[8] ="Vlr. Pagamento"
   CAB[9] ="Cod. Banco"
   CAB[10] ="Origem"
   CAB[11]="Protesto"
   CAB[12]="Contabil"
   CAB[13]="Obs."
   CAB[14]="Multa"
   CAB[15]="Tx. perm."
   CAB[16]="Tx. Comis."
   CAB[17]="Cod.Conta"
   @ 10,00 TO 21,79 DOUBLE
   DBEDIT(11,01,21,78,CAMPO,"F_CONS",PIC,CAB,CHR(196),CHR(179),CHR(205))
   PLQUA("01")
   PPERG("Deseja Totalizaá∆o (S/N) ? ")
   IF sisRESP = "S"
      PLIMPA()
      PCENTRA("TOTALIZAÄ«O DE PAGAMENTOS",9)
      eTOT_PARC = 0
      eTOT_PAGO = 0
      eTOT_TIT  = 0
      eMULTA    = 0
      GOTO TOP
      PLQUA("01")
      PMENSAG("Aguarde, Efetuando o processo de Totalizaá∆o ...")
      DO WHILE .NOT. EOF()
         eTOT_PAGO = eTOT_PAGO + VLR_PGTO
         eTOT_PARC = eTOT_PARC + VLR_PARC
         eTOT_TIT  = eTOT_TIT + 1
         SKIP
      ENDDO
      @ 10,10 SAY "Total Parcelas  : " GET eTOT_PARC PICT "@R 999,999,999,999.99"
      @ 12,10 SAY "Total Pago      : " GET eTOT_PAGO PICT "@R 999,999,999,999.99"
      eMULTA = eTOT_PAGO - eTOT_PARC
      @ 14,10 SAY "Total Multa/Juro: " GET eMULTA    PICT "@R 999,999,999,999.99"
      @ 16,10 SAY "Námero Parcelas : " GET eTOT_TIT  PICT "@R 999,999"
      CLEAR GETS
      PPARA()
   ENDIF
ENDIF
CLOSE DATABASES
RESTORE SCREEN FROM TELA03
RETURN nil
*************************  fim  *********************************
PROCEDURE SEL_BOLE
DO CASE
CASE ePERIODO = "T"
   DO CASE
      CASE eTIPO = "A"
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE 
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR ORIGEM = "B" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR ORIGEM = " " .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO 
            ENDIF
         ENDIF
      CASE eTIPO = "N"
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
               .AND. ORIGEM = "B" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
               .AND. ORIGEM = " " .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ENDIF
         ENDIF
      CASE eTIPO = "I" 
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO 
         ELSE
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ENDIF
         ENDIF
      CASE eTIPO = "S" 
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ENDIF
         ENDIF
   ENDCASE
CASE ePERIODO = "A"
   DO CASE
      CASE eTIPO = "A"
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE 
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO 
            ENDIF
         ENDIF
      CASE eTIPO = "N"
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
               .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
               .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ENDIF
         ENDIF
      CASE eTIPO = "I" 
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ENDIF
         ENDIF
      CASE eTIPO = "S" 
         IF eORIGEM = "A"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            IF eORIGEM = "C"
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ELSE
               APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI) .AND. ALLTRIM(COD_BANCO) = eBOLETO
            ENDIF
         ENDIF
   ENDCASE
CASE ePERIODO = "P"
DO CASE
   CASE eTIPO = "A"
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE 
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO 
         ENDIF
      ENDIF
   CASE eTIPO = "N"
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "I" 
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "S" 
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   ENDCASE
CASE ePERIODO = "M"
DO CASE
   CASE eTIPO = "A"
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE 
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO 
         ENDIF
      ENDIF
   CASE eTIPO = "N"
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
         .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "I" 
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "S" 
      IF eORIGEM = "A"
         APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM) .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM &eARQ FOR SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   ENDCASE
ENDCASE
RETURN nil
*************************  fim  *********************************
function SEL_QBOL()
DO CASE
CASE ePERIODO = "T"
DO CASE
   CASE eTIPO = "A"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE 
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = "B" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = " " .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO 
         ENDIF
      ENDIF
   CASE eTIPO = "N"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL;
         .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = "B" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = " " .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "I" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND.CONTABIL.AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL.AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "S" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. ALLTRIM(COD_BANCO) = eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   ENDCASE
CASE ePERIODO = "A"
DO CASE
   CASE eTIPO = "A"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI).AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE 
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "N"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
         .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI).AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "I" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "S" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC < eDATA_INI);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   ENDCASE
CASE ePERIODO = "P"
DO CASE
   CASE eTIPO = "A"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE 
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO 
         ENDIF
      ENDIF
   CASE eTIPO = "N"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "I" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "S" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC > eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   ENDCASE
CASE ePERIODO = "M"
DO CASE
   CASE eTIPO = "A"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE 
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "N"
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R") .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. (SUBSTR(TIPO_PARC,1,1) = "N" .OR. SUBSTR(TIPO_PARC,1,1) = "R");
            .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM).AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "I" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "I" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   CASE eTIPO = "S" 
      IF eORIGEM = "A"
         APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
         .AND.ALLTRIM(COD_BANCO)=eBOLETO
      ELSE
         IF eORIGEM = "C"
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = "B" .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ELSE
            APPEND FROM CAD_QUIT FOR CLASSE = eIND_CLAS .AND. QUADRA = eIND_QUAD .AND. SUBSTR(TIPO_PARC,1,1) = "S" .AND. ORIGEM = " " .AND. CONTABIL .AND. (DATA_VENC >= eDATA_INI .AND. DATA_VENC <= eDATA_FIM);
            .AND.ALLTRIM(COD_BANCO)=eBOLETO
         ENDIF
      ENDIF
   ENDCASE
ENDCASE
RETURN nil
*************************  fim  *********************************

